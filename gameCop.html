<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
    <title>체스 게임</title>
    <link rel="stylesheet" href="style.css">
    <style>

    body, html {
        background-color: #2c2c2c;
        color: #f5f5f5;
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        display: grid;
        grid-template-columns: 250px 1fr;
        height: 100vh;
    }

    .chessboard {
      position: relative;
      width: 640px;
      height: 640px;
      background-image: url('/images/체스판만.jpg');
      background-size: contain;
      background-repeat: no-repeat;
      margin-left:100px;
      margin-top:53px;
    }


    .chessboard img{
        cursor: pointer;
    }

    .bottomPawn {
        position: absolute;
        width: 33px; /* 폰의 크기를 칸에 맞게 조정 */
        height: auto;
        bottom:123px;
        /* 'top'과 'left' 속성을 인라인 스타일에서 제거하고, 클래스에 스타일을 추가 */
    }


    .otherBottom {
        position: absolute;
        width: 33px; /* 폰의 크기를 칸에 맞게 조정 */
        height: auto;
        bottom: 55px;
        /* 'top'과 'left' 속성을 인라인 스타일에서 제거하고, 클래스에 스타일을 추가 */
    }

    .otherTop {
        position: absolute;
        width: 31px; 
        height: auto;
        bottom:505px;
    }


    .topPawn {
        position: absolute;
        width: 33px; /* 폰의 크기를 칸에 맞게 조정 */
        height: auto;
        top:90px;
    }


    /*  sidebar  */
       .sidebar {
            background-color: #202020;
            padding-top: 20px;
            display: flex;
            flex-direction: column;
            height: 100%;
        }



        .sidebar-links, .sidebar-bottom {
            display: flex;
            flex-direction: column;
        }



        .sidebar-bottom {
            margin-top: auto; 
            padding-bottom: 20px;
        }



        .sidebar a {
            padding: 6px 8px 6px 16px;
            text-decoration: none;
            font-size: 18px;
            color: #9e9e9e;
            display: block;
            transition: 0.3s;
        }



        .sidebar a.active,
        .sidebar a:hover {
            background-color: #4f1919;; /* 기존 색상 유지 혹은 더 어두운 색상으로 변경 가능 */
            color: white; /* 텍스트 색상을 흰색으로 */
        }

        .sidebar-icon {
            width: 25px; /* 또는 적절한 크기 */
            height: 25px; /* 또는 적절한 크기 */
            vertical-align: middle; /* 텍스트와 중앙 정렬 */
            margin-right: 5px; /* 아이콘과 텍스트 사이의 여백 */
        }


        .yourProfile {
          display: flex; /* 내부 아이템을 가로로 배치 */
          align-items: center; /* 내부 아이템을 중앙 정렬 */
          justify-content: center; /* 내부 내용을 중앙 정렬 */
          position: absolute;
          top: -45px; /* 체스판 바로 위에 오도록 조정, 필요에 따라 값 조정 */
          left: 18%; /* 화면 가운데에 위치하도록 설정 */
          transform: translateX(-50%); /* 요소의 중심을 기준으로 좌우 위치 조정 */
          text-decoration: none; /* 링크의 밑줄 제거 */
          color: inherit; /* 링크의 글씨 색상을 상속받음 */
        }

        .yourProfile img {
          width: 40px; /* 기존 설정 유지 */
          height: auto; /* 기존 설정 유지 */
          margin-right: 10px; /* 이미지와 텍스트 사이의 간격 */
        }


        .myProfile {
          display: flex; /* 내부 아이템을 가로로 배치 */
          align-items: center; /* 내부 아이템을 중앙 정렬 */
          justify-content: center; /* 내부 내용을 중앙 정렬 */
          position: absolute;
          bottom: -45px; /* 체스판 바로 위에 오도록 조정, 필요에 따라 값 조정 */
          left: 18%; /* 화면 가운데에 위치하도록 설정 */
          transform: translateX(-50%); /* 요소의 중심을 기준으로 좌우 위치 조정 */
          text-decoration: none; /* 링크의 밑줄 제거 */
          color: inherit; /* 링크의 글씨 색상을 상속받음 */
        }

        .myProfile img {
          width: 40px; /* 기존 설정 유지 */
          height: auto; /* 기존 설정 유지 */
          margin-right: 10px; /* 이미지와 텍스트 사이의 간격 */
        }


        .game-controls {
            position: absolute;
            right: -330px; /* Adjusted for better alignment */
            bottom: -20px; /* Position the controls towards the bottom */
            display: flex;
            padding: 20px;
            gap: 10px; /* Ensures some space between buttons */
        }

        .game-controls button {
            margin: 0;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border: none; /* Removes the default border */
            border-radius: 5px; /* Adds rounded corners */
            transition: background-color 0.3s ease; /* Smooth transition for hover effect */
        }

        /* Specific styles for the start and end game buttons to match the chess theme */
        #startGame {
            background-color: #4CAF50; /* A green shade */
            color: white;
        }

        #startGame:hover {
            background-color: #45a049; /* A darker shade of green for hover effect */
        }

        #endGame {
            background-color: #f44336; /* A red shade */
            color: white;
        }

        #endGame:hover {
            background-color: #d7382b; /* A darker shade of red for hover effect */
        }

        .timer {
            position: absolute;
            top: 85px;
            right: -325px; /* Adjust based on your layout */
            transform: translateY(-50%);
            background-color: #333; /* Dark background */
            color: white; /* White text */
            font-size: 24px; /* Larger font size for visibility */
            padding: 70px 100px 70px 100px; /* Some padding around the text */
            border-radius: 10px; /* Rounded corners */
            font-family: 'Arial', sans-serif; /* Consistent font */
        }

        @media (max-width: 768px) {
            .sidebar, .yourProfile, .myProfile, .game-controls, .timer {
                display: none; /* 화면 너비가 768px 이하일 때 숨김 처리 */
            }
            
        }



        

    </style>
</head>
<body>

    <!-- 사이드 바 -->
    <div class="sidebar">
      <div class="sidebar-links">
          <a href="index.html">
              <img src="/images/홈.png" alt="홈" class="sidebar-icon">홈
          </a>
          <a href="#play">
              <img src="/images/플레이.png" alt="플레이" class="sidebar-icon">플레이
          </a>
          <a href="#about">
              <img src="/images/랭킹.png" alt="랭킹" class="sidebar-icon">랭킹
          </a>
          <a href="#about">
              <img src="/images/소셜.png" alt="소셜" class="sidebar-icon">소셜
          </a>
      </div>
      <div class="sidebar-bottom">
          <a href="#help">
              <img src="/images/설정.png" alt="도움말" class="sidebar-icon">설정
          </a>
          <a href="#option">
              <img src="/images/도움말.png" alt="설정" class="sidebar-icon">도움말
          </a>
      </div>
    </div>


    <div class="chessboard">
      <!-- 기존의 <div class="chessboard"> 아래에 버튼 추가 -->
        <div class="game-controls">
         <button id="startGame" type="button" class="btn btn-success">게임 시작</button>
         <button id="endGame" type="button" class = "btn btn-danger">게임 종료</button>
        </div>

        <!--타이머-->
        <div class="timer" id="timer">10:00</div>

        <!-- 상대 프로필 -->
        <a href="#profile" class="yourProfile">
          <img src="/images/회원.png" alt="상대방 프로필">상대
        </a>

        <!-- 윗줄 폰 -->
        <img src="/images/black/pawn.png" class="topPawn" style="left: 12.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 22.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 32.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 42.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 52.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 62.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 72.5%;" draggable="true">
        <img src="/images/black/pawn.png" class="topPawn" style="left: 82.5%;" draggable="true">

        <!-- 아윗줄랫줄 나머지 기물-->
        <img src="/images/black/rook.png" class="otherTop" style="left: 12%;">
        <img src="/images/black/knight.png" class="otherTop" style="left: 22%;">
        <img src="/images/black/bishop.png" class="otherTop" style="left: 32%;">
        <img src="/images/black/queen.png" class="otherTop" style="left: 42%;">
        <img src="/images/black/king.png" class="otherTop" style="left: 52%;">
        <img src="/images/black/bishop.png" class="otherTop" style="left: 62%;">
        <img src="/images/black/knight.png" class="otherTop" style="left: 72%;">
        <img src="/images/black/rook.png" class="otherTop" style="left: 82%;">
        <!-- 나머지 폰들은 비슷한 방식으로 배치 -->
        


        <!-- 아랫줄 폰 -->
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 12.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 22.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 32.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 42.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 52.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 62.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 72.5%;">
        <img src="/images/white/pawn.png" class="bottomPawn" style="left: 82.5%;">

        <!-- 아랫줄 나머지 기물-->
        <img src="/images/white/rook.png" class="otherBottom" style="left: 12%;">
        <img src="/images/white/knight.png" class="otherBottom" style="left: 22%;">
        <img src="/images/white/bishop.png" class="otherBottom" style="left: 32%;">
        <img src="/images/white/queen.png" class="otherBottom" style="left: 42%;">
        <img src="/images/white/king.png" class="otherBottom" style="left: 52%;">
        <img src="/images/white/bishop.png" class="otherBottom" style="left: 62%;">
        <img src="/images/white/knight.png" class="otherBottom" style="left: 72%;">
        <img src="/images/white/rook.png" class="otherBottom" style="left: 82%;">


        <!-- 내 프로필 -->
        <a href="#profile" class="myProfile">
          <img src="/images/회원.png" alt="상대방 프로필">나
        </a>
    </div>





    <script>
          document.addEventListener("DOMContentLoaded", function() {
          // 프로필 이미지 가져오기
          fetchProfileImage();

          // 게임 시작 및 종료 버튼 이벤트 리스너 설정
          document.getElementById("startGame").addEventListener("click", function() {
              // 게임 시작 처리
              startGame();
          });

          document.getElementById("endGame").addEventListener("click", function() {
              // 게임 종료 처리
              endGame();
          });
      });

      function fetchProfileImage() {
          // Fetch API 사용하여 프로필 이미지 가져오기
          // 예시 URL: '/api/profile-image'
          fetch('/api/profile-image')
              .then(response => response.json())
              .then(data => {
                  document.querySelector('.yourProfile img').src = data.yourProfileImage;
                  document.querySelector('.myProfile img').src = data.myProfileImage;
              })
              .catch(error => console.error('Error:', error));
      }

      function startGame() {
          // 게임 시작 로직 서버로 보내기
          fetch('/api/start-game', { method: 'POST' })
              .then(response => response.json())
              .then(data => console.log('Game started:', data))
              .catch(error => console.error('Error:', error));
      }

      function endGame() {
          // 게임 종료 로직 서버로 보내기
          fetch('/api/end-game', { method: 'POST' })
              .then(response => response.json())
              .then(data => console.log('Game ended:', data))
              .catch(error => console.error('Error:', error));
      }

      // 말의 위치 변경 및 리플레이 기능을 위한 데이터 보내기 등의 추가 기능은
      // 여기에 JavaScript로 구현하되, 드래그 앤 드롭 인터페이스 및 이벤트 핸들링에 주의를 기울여야 합니다.


        document.addEventListener('DOMContentLoaded', function () {
        let draggedElement = null; // 드래그되는 말을 저장하는 변수

        // 드래그 시작 시 이벤트 핸들러
        document.querySelectorAll('.chessboard img').forEach(item => {
            item.addEventListener('dragstart', function (e) {
                draggedElement = this; // 현재 드래그되는 말을 저장
            });
        });
        
        
        // 체스판 위에서 드래그 오버(드래그 중인 상태) 발생 시 이벤트 핸들러
        document.querySelector('.chessboard').addEventListener('dragover', function (e) {
            e.preventDefault(); // 드래그 오버 시 기본 동작을 방지
        });

        // 드롭 시 이벤트 핸들러
        document.querySelector('.chessboard').addEventListener('drop', function (e) {
            e.preventDefault(); // 드롭 시 기본 동작을 방지

            // 드래그된 말의 새로운 위치 설정
            // 여기서 e.clientX와 e.clientY는 마우스 포인터의 위치입니다.
            // 체스판의 상대 위치를 계산하여 말을 이동시켜야 합니다.
            // 이는 체스판의 위치와 마우스 포인터의 위치를 고려하여 계산해야 합니다.
            const chessboardRect = document.querySelector('.chessboard').getBoundingClientRect();
            const newX = e.clientX - chessboardRect.left - (draggedElement.offsetWidth / 2);
            const newY = e.clientY - chessboardRect.top - (draggedElement.offsetHeight / 2);

            // 말의 새 위치를 스타일로 설정
            draggedElement.style.position = 'absolute';
            draggedElement.style.left = `${newX}px`;
            draggedElement.style.top = `${newY}px`;

            // 위치 변경 후 서버에 데이터 전송 로직 추가 가능
        });

    });


            
    

    </script>
</body>
</html>
